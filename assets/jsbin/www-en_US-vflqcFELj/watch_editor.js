(function(g){var window=this;var d4=function(a){this.j=a;this.A="/gen_204";this.j&&(this.A=this.j.A);this.l=[];this.j&&(this.l=this.j.l);this.B=new g.Li;this.C=new g.Li};var e4=function(a){var b=new g.Li;a.j&&(b=e4(a.j));g.Mi(b,a.B);a.C.forEach(function(a,d){b.set(d,(0,g.G)()-a)});return b};var f4=function(a,b){g.cC("mute_suggested_edit",g.fa,{video_id:a,effect:b},null,"w")};var g4=function(){};
var h4=function(a,b,c){this.C=a;this.B=b;if(this.j=g.E("edit-confirmation-alert"))a=g.el("edit-confirmation-alert-template"),g.Bs("yt-alert-info",c,a,this.j),c=g.F("edit-confirmation-yes",this.j),a=g.F("edit-confirmation-no",this.j),b=g.F("yt-uix-close",this.j),this.l=[],this.l.push(g.L(c,"click",(0,g.q)(this.D,this))),this.l.push(g.L(a,"click",(0,g.q)(this.F,this))),this.l.push(g.L(b,"click",(0,g.q)(this.A,this)))};
var i4=function(a,b){var c={encrypted_project_id:a.B};c.video_id=a.C;g.cC(b+"_suggested_edit",g.ph,c)};var j4=function(a,b,c){g.wf.call(this,a,c);this.Xb=b||null};var k4=function(a,b){this.j=a;this.rb=b};var l4=function(a){g.Dr.call(this);this.B=new g4;this.A=new g.Lk;this.j=null;this.l=a};
var m4=function(a,b,c){a=a.split(":");this.F={name:a[0],version:a[1],token:a[2]};this.B=b;g.xb(this.B,function(){});b=c;b||(b=new g.Uw(2E3),b.start());this.L=b;g.Ef(this.L,"tick",this.X,!1,this);this.j={};this.l=0;this.C=new g.kA(2E3,6E4)};var nqa=function(a){this.type="editor_progress";this.item=a};var n4=function(a){var b=a.C.j*(Math.random()+.5);a.A=(0,g.G)()+b;a=a.C;a.j=Math.min(a.l,2*a.j)};
var o4=function(a,b,c){var d=b.j;if(d){var e=a.j[d];e&&(e=(0,g.Id)(e,function(a){return a.item!=b||g.ca(c)&&c!=a.type}),g.$l(e)?delete a.j[d]:a.j[d]=e)}};var oqa=function(a){var b={id:{},choice:{}},c;a:{for(c in a){c=a[c];break a}c=void 0}var d=p4(c.item.j.j);b.id[d]=c.item.j.getId();for(var e in a)c.item.j.getId(),a[e].item.j.getId(),d=p4(a[e].type),b.choice[d]=!0;return b};var p4=function(a){return a.replace(/_([a-z])/g,function(a,c){return c.toUpperCase()})};
var q4=function(){var a=g.x("EDITOR_PROGRESS_FEEDBACK_KEY");if(!r4){a=r4=new s4(a);t4(a,g.db("EDITS_PROCESSING_MESSAGE"));a.l=g.Ef(a.j,"w",a.B,!1,a);var a=a.j,b=a.l,c=a.j;c&&(c in b.j||(b.j[c]=[]),b.j[c].push(new nqa(a)))}};var s4=function(a){var b=new m4(g.x("APIARY_FEEDBACK_CLIENT_ID"),g.x("APIARY_FEEDBACK_URLS"));this.j=new l4(b);this.j.j=new k4("frontend_key",a)};
var t4=function(a,b){a.A&&(g.Kc(a.A.parentNode),a.A=null);var c=g.E("editor-progress-alert-container"),d=g.el("editor-progress-alert-template");a.A=g.Bs("yt-alert-warn",b,d,c)};
var u4=function(a,b,c){g.u.call(this);this.C=a;this.l=b;this.l.sort();this.F=c;this.A=new g.zA(this);if(a=g.db("EDITOR_SUGGEST_"+this.l.join("_")))if(b=g.E("edit-suggestion-alert"),c=g.E("edit-suggestion-alert-template").cloneNode(!0),this.B=g.Bs("yt-alert-info",a,c,b),a=g.F("edit-suggestion-preview",this.B),b=g.F("close",this.B),this.A.O(a,"click",this.eE),this.A.O(b,"click",this.YB),this.j=g.E("edit-suggestion-confirmation-alert-container"))a=g.F("edit-suggestion-action-yes",this.j),b=g.F("edit-suggestion-action-no",
this.j),this.A.O(a,"click",this.NI),this.A.O(b,"click",this.MI)};var v4=function(a){var b=g.n("ytplayer.config");g.qg(a.F,b)};d4.prototype.send=function(a){var b=e4(this);a&&g.Mi(b,a);var c=new g.Kj(this.A);for(a=0;a<this.l.length;a++){var d=this.l[a],e=b.get(d);void 0!==e&&g.Rj(c,d,e.toString());b.remove(d)}b.forEach(function(a,b){g.Rj(c,b,a.toString())});g.ed(c.toString())};g.t(g4,d4);g4.prototype.send=function(){};var w4;h4.prototype.dispose=function(){g.M(this.l);this.l=[]};
h4.prototype.D=function(){g.R(this.j);i4(this,"confirm")};h4.prototype.F=function(){g.R(this.j);i4(this,"revert")};h4.prototype.A=function(){i4(this,"confirm")};g.t(j4,g.wf);k4.prototype.getId=function(){return this.rb};k4.prototype.toString=function(){return this.j+"::"+this.rb};g.t(l4,g.Dr);l4.prototype.stop=function(){o4(this.l,this)};m4.prototype.X=function(){if(!g.gk(this.j))if(this.l)2E3<=(0,g.G)()-this.l&&(n4(this),this.l=0);else if(!this.A||this.A<(0,g.G)()){var a;a:{var b=0;a=Math.random();for(var c in this.B)if(b+=this.B[c],b>a){a=c+"/list";break a}a=""}var b=g.T,d;c={client:this.F,queries:[]};for(d in this.j)c.queries.push(oqa(this.j[d]));d=g.ho(c);b(a,{md:d,T:(0,g.q)(this.K,this),onError:(0,g.q)(this.G,this),method:"POST",headers:{"Content-Type":"application/json"}});this.l=(0,g.G)()}};
m4.prototype.G=function(a){500!=a.status&&503!=a.status||n4(this)};m4.prototype.K=function(a,b){this.l=0;if(!this.A||this.A<(0,g.G)())this.C.reset(),this.A=null;b&&b.items&&304!=a.status&&(0,g.A)(b.items,(0,g.q)(this.D,this))};
m4.prototype.D=function(a){if(a.id&&a.feedback){var b=a.id,c=null;g.pa(b)?g.xb(b,function(a,b){var f=b.replace(/([A-Z])/g,"_$1").toLowerCase();c=new k4(f,a)}):c=new k4("upload_id",b);g.xb(this.j[c],function(b){var c=p4(b.type);if(c=a.feedback[c]){var f=b.item;b=b.type;if(!f.A.contains(b)){f.A.add(b);var k=new g.Li;k.set("a","feedback_service");k.set("fty",b);f.B.send(k)}k=null;switch(b){case "video_id":k="o";break;case "video_info2":k="p";break;case "video_issues":k="q";break;case "processing_progress":k=
"r";break;case "processing_done":k="s";break;case "youtube_status":k="t";break;case "thumbnails_done":k="u";break;case "editor_suggestions":k="v";break;case "editor_progress":k="w"}k&&f.dispatchEvent(new j4(k,c))}})}};var r4;s4.prototype.dispose=function(){this.l&&(g.Mf(this.l),this.l=null);this.j&&this.j.stop()};s4.prototype.B=function(a){var b=a.Xb.produced;a=0<=b&&1>=b?g.db("EDITS_PROCESSING_MESSAGE_WITH_PROGRESS",{"{percent}":Math.round(100*(.1+.8*b))}):g.db("EDITS_PROCESSING_MESSAGE");t4(this,a);1<=b&&(a=this.j,o4(a.l,a,"editor_progress"))};var x4;g.t(u4,g.u);g.h=u4.prototype;g.h.eE=function(){g.R(this.B);var a=this.l.join(","),b=(0,g.q)(this.fE,this);g.cC("preview_suggested_edit",b,{video_id:this.C,effect:a},null,"w")};g.h.fE=function(a){var b=g.n("ytplayer.config"),b=g.Ld(b).clone();b.minVersion="10";b.disable.html5=!0;b.args.dash="0";b.args.partnerid=28;for(var c in a.flashvars)b.args[c]=a.flashvars[c];b.loaded=!1;g.qg(this.F,b);g.N(this.j)};
g.h.NI=function(){g.R(this.j);v4(this);var a=this.l.join(","),b=(0,g.q)(this.CC,this);g.cC("publish_suggested_edit",b,{video_id:this.C,effect:a,metadata_only:!1},null,"w")};g.h.CC=function(a){g.Ta("EDITOR_PROGRESS_FEEDBACK_KEY",a.feedback_key);q4()};g.h.MI=function(){g.R(this.j);v4(this);f4(this.C,this.l.join(","))};g.h.YB=function(){g.R(this.B);f4(this.C,this.l.join(","))};g.h.R=function(){this.A.removeAll();u4.J.R.call(this)};g.ub(g.Ql({name:"www/watch_editor",deps:["www/watch"],page:"watch",init:function(){g.x("WATCH_EDITOR_SHOW_PROCESSING")&&q4();g.x("WATCH_EDITOR_SHOW_ENHANCE_CONFIRMATION")&&(w4&&(w4.dispose(),w4=null),w4=new h4(g.x("VIDEO_ID"),g.x("WATCH_EDITOR_PROJECT_ID"),g.x("WATCH_EDITOR_ENHANCE_CONFIRMATION_MESSAGE")));g.x("ENHANCE_SUGGESTIONS")&&(x4||(x4=new u4(g.x("VIDEO_ID"),g.x("ENHANCE_SUGGESTIONS"),g.x("PLAYER_TARGET"))))},dispose:function(){r4&&(r4.dispose(),r4=null);w4&&(w4.dispose(),w4=null);x4&&(x4.dispose(),
x4=null)}}));})(_yt_www);
